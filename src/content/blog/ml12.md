---
title: "(理論)ガウス過程回帰を理解したい-Gaussian Process Regression"
description: ""
pubDate: "Jul 08 2023"
pubDatetime: 2023-09-20T15:33:05.569Z
---

<h2>はじめに</h2>
最近、GPLVMに関係する論文を読んでたんですが、そもそもガウス過程について全く理解していなかったので勉強がてら記事にしてまとめてみました。

本記事ではガウス過程回帰の導出について書きました。

&nbsp;

<h3>本記事の主な流れ</h3>
ガウス過程回帰を導出するに至って次の流れで求めていきま。

[st-mybox title="ガウス過程回帰への流れ" fontawesome="fa-file-text-o" color="#757575" bordercolor="#f3f3f3" bgcolor="" borderwidth="3" borderradius="5" titleweight="bold" title_bordercolor="#757575" fontsize="" myclass="st-mybox-class st-title-under st-list-check" margin="25px 0 25px 0"]

<ul>
 	<li>線形回帰モデルに対してベイズ推定の枠組みを導入</li>
 	<li>ベイズ推定の枠組みにおけるパラメータ$w$の事後分布を推定する</li>
 	<li>新規のデータに対して得られる予測分布を算出する</li>
 	<li>得られた予測分布に対してカーネルの枠組みを導入する</li>
 	<li>カーネル関数を用いた予測分布が得られる</li>
</ul>
[/st-mybox]

&nbsp;

<h2>線形回帰モデル</h2>
線形回帰モデルは基底関数における特徴ベクトルの数を増やすことで複雑な関数も表現できました。

$$f(x)=w_1\varphi_2(x)+w_2\varphi_2(x)+\dots+w_m\varphi_m(x)=\sum_{i}^{m}w_{i}\varphi_{i}(x)$$

上記の線形回帰のモデルの式からわかるように1次元の$x$に対して$N$個の特徴ベクトルで考えるとき、それに対応する基底関数の数も$N$個必要になります。

このとき、$x$の次元が2次元の場合は基底関数は$N^2$個必要になり、3次元の場合は$N^3$個必要になります。

このように$x$の次元が大きくなると必要な基底関数は指数関数的に増大します。

つまり、線形回帰のモデルは$x$の次元が低いときにのみ有効なのです。

[st-card myclass="" id=1346 label="関連記事" pc_height="" name="" bgcolor="" color="" fontawesome="" readmore="on"]

<h2>ベイズ線形回帰</h2>
線形回帰では予測したい出力$y_n<span id="MathJax-Element-25-Frame" class="MathJax" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 15px; vertical-align: baseline; background: transparent; display: inline; font-style: normal; font-weight: normal; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;"><span id="MathJax-Span-376" class="math"><span id="MathJax-Span-377" class="mrow"><span id="MathJax-Span-378" class="msubsup"><span id="MathJax-Span-380" class="mi">$を</span></span></span></span></span>、入力$x_n<span id="MathJax-Element-26-Frame" class="MathJax" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 15px; vertical-align: baseline; background: transparent; display: inline; font-style: normal; font-weight: normal; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;"><span id="MathJax-Span-381" class="math"><span id="MathJax-Span-382" class="mrow"><span id="MathJax-Span-383" class="msubsup"><span id="MathJax-Span-385" class="mi">$</span></span></span></span></span>と重みベクトル$<span id="MathJax-Element-27-Frame" class="MathJax" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 15px; vertical-align: baseline; background: transparent; display: inline; font-style: normal; font-weight: normal; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;"><span class="MJX_Assistive_MathML" role="presentation">w$</span></span>によって決定しました。このとき、$x_n$と$y_n$は観測された変数ですが、重みベクトル$<span id="MathJax-Element-29-Frame" class="MathJax" style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-size: 15px; vertical-align: baseline; background: transparent; display: inline; font-style: normal; font-weight: normal; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;"><span class="MJX_Assistive_MathML" role="presentation">w$</span></span>は未知の変数です。線形回帰では未知の重みベクトル$w$を推定するのですが、ここにベイズ推定の枠組みを導入します。

ベイズ線形回帰では、推定対象となるパラメータ$w$に確率分布を仮定します。 つまり、パラメータ$w$はある確率分布に従う確率変数であると考えます。

<h3>問題設定</h3>
<h4>Given</h4>
学習データセット

$$X=(x_1,y_1),\dots,(x_n,y_n)$$

パラメータ$w$の事前分布

$$p(\mathbf{w}|\alpha)=N(\mathbf{w}|\mathbf 0,\alpha^{-1}\mathbf I)$$

<h4>Estimate</h4>
パラメータ$w$の事後分布$p(\mathbf{w}|X)$

$$p(\mathbf{w}|X)=\frac{p(X|\mathbf{w})p(\mathbf{w})}{p(X)}$$

新規の入力$x^{\ast}$に対する予測確率分布$p(y^{\ast}|x^{\ast},X)$

$$p(y^{\ast}|x^{\ast},X)=\int p(y^{\ast}|x^{\ast},\mathbf{w})p(\mathbf{w}|X)d \mathbf{w}$$

&nbsp;

<h2>対数尤度を求める</h2>
ここから先は最尤推定やガウス分布などの知識が必要になります。

必要な知識の概要を簡単に書きました

[st-slidebox fontawesome="" text=" <strong>必要知識の簡単な復習はこちら</strong>" bgcolor="#d6e9ca" color="#1a1a1a" margin_bottom="20"]

<h4>確率密度関数</h4>
連続型確率変数$X$がある値$x$をとる確率密度を関数$f(x)$とすると、$f(x)$を「<span class="huto"><span class="st-mymarker-s">確率密度関数</span></span>」と言います。

性質としては、連続型確率変数$A$の取りうる値の下限値を$<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="mord mathnormal">A$</span></span></span></span> ，上限値を$B$とおくとき、下限がないときは$A=-\infty$上限がないときは$B=-\infty$になります。$f(x)$が確率密度関数のとき$\int_A^Bf(x)dx=1$が成り立つ。

&nbsp;

<h4>正規分布(ガウス分布)</h4>
確率関数$X$が平均$\mu$、分散$\sigma^2$ の正規分布に従うとき、その確率密度関数は以下のように表すことができる。

$$f(X, \mu,\sigma^2)=\frac{1}{\sqrt{2\pi\sigma}}\exp(-\dfrac{(X-\mu)^ 2}{2\sigma^ 2})$$

主な性質は以下のものがある。

<ul>
 	<li><span class="st-mymarker-s"><strong>平均値と最頻値と中央値が一致</strong></span></li>
 	<li><span id="MathJax-Element-8-Frame" class="MathJax" style="padding: 0px; margin: 0px; font-family: 游ゴシック体, YuGothic, 游ゴシック, 'Yu Gothic', メイリオ, sans-serif; display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-137" class="math"><span id="MathJax-Span-138" class="mrow"><span id="MathJax-Span-139" class="mi">$x$</span></span></span></span>軸が漸近線</li>
 	<li>平均値を中心にして左右対称</li>
 	<li>分散（標準偏差）が大きくなると左右に広がって平らになる。分散（標準偏差）が小さくなると、よりとんがった形になる。</li>
</ul>
<h4>最尤推定</h4>
パラメータ$\theta$に従う分布の密度関数を$f(x;\theta)$とする。尤度関数を$L(\theta;x)=f(\theta;x)$とすると、$L(\theta;x)$を最大にするような推定量$\theta$を<strong>最尤推定量</strong>という。

「最尤」の意味は文字通り<strong>「一番尤もらしい」</strong>という意味になります。つまり、最尤法によるパラメータ推定とは、データから<strong>一番尤もらしいパラメータを推定する</strong>手法のことです。この手法によって推定されたパラメータを<strong>最尤推定量</strong>と呼びます。

$L(\theta;x)$が最大となるような$\theta$を考えるときに、微分を行いますが、そのまま微分をすると非常に複雑な計算を要するため<strong>尤度関数の対数を取った対数尤度</strong>$log L(\theta;x)$を考えます。なぜこんなことするのかというと、。対数を取ると、積ではなく、和の形になりますので、微分式を解くのにも計算が楽となるのと、ある関数の対数の最大化はその関数の最大化と同値なので、対数に置き換えても影響はないからです

[/st-slidebox]

&nbsp;

入力とパラメータ$w$がわかっているときの観測される確率分布は次のガウス分布$N(y_n|f(x_n),\beta^{^-1})$に従います(尤度関数)

分散である$\beta^{^-1}$はノイズです。

$${\begin{eqnarray}p\left(y_n|x_n,\mathbf{w}\right)&amp;=&amp;N\left(y_n|f(x_n),\beta^{^-1}\right)\\&amp;=&amp;\sqrt\frac{\beta}{{2\pi}}\exp\left(-\frac{\beta}{2}(y_n-f(x_n))^{2}\right)\\&amp;=&amp;\sqrt\frac{\beta}{{2\pi}}\exp\left(-\frac{\beta}{2}\left(y_n-\mathbf{w}^{T}\boldsymbol{\varphi}\left(x_n\right)\right)^{2}\right)\end{eqnarray}}$$

この対数尤度を取ると

$$\ln{p(y_n|x_n,\mathbf{w})}=[-\frac{\beta}{2}(y_n-\mathbf{w}^{T}\boldsymbol{\varphi}(x_n))^2]+const$$

<span id="MathJax-Element-35-Frame" class="MathJax" style="box-sizing: inherit; display: inline-block; font-style: normal; font-weight: 400; line-height: normal; font-size: 16px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: 0px; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: 100%; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; overflow: auto hidden; vertical-align: text-top; color: #333333; font-family: -apple-system, 'Segoe UI', 'Helvetica Neue', 'Hiragino Kaku Gothic ProN', メイリオ, meiryo, sans-serif; font-variant-ligatures: normal; font-variant-caps: normal; orphans: 2; widows: 2; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; position: relative;" tabindex="0" role="presentation" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;"><span id="MathJax-Span-938" class="math" role="math"><span id="MathJax-Span-939" class="mrow"><span id="MathJax-Span-940" class="mi">c</span><span id="MathJax-Span-941" class="mi">o</span><span id="MathJax-Span-942" class="mi">n</span><span id="MathJax-Span-943" class="mi">st</span></span></span></span>は$w$に関して定数であることを表しています。

これらは特定の$n$番目のデータにおける対数尤度でした。

これを全てのデータについて考えますと尤度関数と対数尤度はそれぞれ次のようになります。

$$p(X|\mathbf{w})=\prod_{n=1}^{N} p(y_n|x_n, \mathbf{w})$$

$${\begin{eqnarray}\ln{p(X|\mathbf{w})}&amp;=&amp;\sum_{n=1}^{N}[-\frac{\beta}{2}(y_n-\mathbf{w}^{T}\boldsymbol{\varphi}(x_n))^2]+const\\&amp;=&amp;-\frac{\beta}{2}||\mathbf{w}^{T}\Phi - y||^2+const \end{eqnarray}}$$

&nbsp;

<h2>パラメータ$w$の事後分布を求める</h2>
[st-slidebox fontawesome="" text=" <strong>ベイズの定理の復習はこちら</strong>" bgcolor="#d6e9ca" color="#1a1a1a" margin_bottom="20"]

同時分布$P(A,B)$において、$B$がわかったときの$A$の確率分布(条件付き確率分布)、$A$がわかったときの$B$の確率分布(条件付き確率分布)は次のように表すことができます。

$$P(A|B)=\frac{P(A\cap B)}{P(B)}\,\,\,\,\,,\,\,\,\,\,P(B|A)=\frac{P(A\cap B)}{P(A)}$$

これらの式から次のことが導けます。

$$P(x|y)=\frac{P(y|x)P(x)}{P(y)}$$

<span class="cmsBgcolorGray">P(x)</span>は<strong>事前確率</strong>、<span class="cmsBgcolorGray">P(x|y)</span>は<strong>事後確率</strong>、<span class="cmsBgcolorGray">P(y|x)</span>は<strong>尤度（ゆうど）</strong>、<span class="cmsBgcolorGray">P(y)</span>は<strong>周辺尤度</strong>と呼ばれます。

$$事後分布=\frac{尤度 \times 事前分布}{周辺分布}$$

<span id="MathJax-Element-31-Frame" class="MathJax" tabindex="0"><span id="MathJax-Span-436" class="math"><span id="MathJax-Span-437" class="mrow"><span id="MathJax-Span-438" class="mi">このとき、$A$</span></span></span></span>の取りうる値が複数あるとすると、$A_i(i=1,2,\dots,n)$が互いに独立であるという条件の下では

$$P(B)=\sum_{i=1}^{n}P(A_i \cap B)=\sum_{i=1}^{n}P(B|A_i)P(A_i)$$

よって

$$P(A_i|B)=\frac{P(B|A_i)P(A_i)}{P(B)}=\frac{P(B|A_i)P(A_i)}{\sum_{i=1}^{n}P(A_i)P(B|A_i)}$$

これは離散型のベイズの定理ですが$\sum$を$\int$にすれば連続型になります

連続型ベイズの定理の分母（周辺尤度）について着目すると、積分することから周辺尤度は定数になります。つまり、比例の記号を用いて

$$事後分布 \propto 尤度 \times事前分布$$

が成り立ちます。

[/st-slidebox]

[st-slidebox fontawesome="" text=" <strong>共役事前分布についてはこちら</strong>" bgcolor="#d6e9ca" color="#1a1a1a" margin_bottom="20"]

ベイズ推定は式の形から、事前分布が複雑であると、その事後分布の計算も複雑なります。

そこで、事後分布の形が簡単になるような、尤度関数と事前分布を選択したいところです。

一般的には、事前分布としてある確率分布を選び、尤度関数にかけたら、その事後分布も同じ確率分布の形で表せられるような確率分布が存在していることが知られています。

ある確率分布を選んで事前分布としてベイズ推定を行った時、その事後分布もその確率分布の形で表されるとき、その事前分布（確率分布）のことを<span class="st-mymarker-s">共役事前分布</span>と言います。

したがって、<span class="st-mymarker-s">共役事前分布とは、ベイズ推定において「事後分布」と「事前分布」が同じ形になるように選んだ「事前分布」のことです。</span>

共役事前分布は尤度関数の形に応じて決められるので、代表的なものをいくつかあげると、次の表のようになります。

<table style="border-collapse: collapse; width: 57.5328%; height: 108px;">
<tbody>
<tr style="height: 18px;">
<td style="width: 18.9879%; height: 18px; text-align: center;"><strong>事前分布</strong></td>
<td style="width: 19.076%; height: 18px; text-align: center;"><strong>尤度</strong></td>
<td style="width: 21.3264%; height: 18px; text-align: center;"><strong>事後分布</strong></td>
</tr>
<tr style="height: 18px;">
<td style="width: 18.9879%; height: 18px; text-align: center;">ガンマ分布</td>
<td style="width: 19.076%; height: 18px; text-align: center;">ポアソン分布</td>
<td style="width: 21.3264%; height: 18px; text-align: center;">ガンマ分布</td>
</tr>
<tr style="height: 18px;">
<td style="width: 18.9879%; height: 18px; text-align: center;">逆ガンマ分布</td>
<td style="width: 19.076%; height: 18px; text-align: center;">正規分布</td>
<td style="width: 21.3264%; height: 18px; text-align: center;">逆ガンマ分布</td>
</tr>
<tr style="height: 18px;">
<td style="width: 18.9879%; height: 18px; text-align: center;">ベータ分布</td>
<td style="width: 19.076%; height: 18px; text-align: center;">二項分布</td>
<td style="width: 21.3264%; height: 18px; text-align: center;">ベータ分布</td>
</tr>
<tr style="height: 18px;">
<td style="width: 18.9879%; height: 18px; text-align: center;">正規分布</td>
<td style="width: 19.076%; height: 18px; text-align: center;">正規分布</td>
<td style="width: 21.3264%; height: 18px; text-align: center;">正規分布</td>
</tr>
</tbody>
</table>
[/st-slidebox]

&nbsp;

パラメータ$w$の事後分布を求めます。

ベイズの定理より$p(\mathbf{w}|X)=\frac{p(X|\mathbf{w})p({\mathbf{w}})}{p({\mathbf{X}})}$

対数をとって

$${\begin{eqnarray} \ln p(\mathbf{w}|X)&amp;=&amp;\ln{p(X|\mathbf{w})}+\ln p({\mathbf{w}})-\ln p({\mathbf{X}})\\&amp;=&amp;-\frac{\beta}{2}||y-\mathbf{w}^{T}\Phi||^2-\frac{\alpha}{2}||\mathbf{w}||^2+const\\&amp;=&amp;-\frac{\beta}{2}(\mathbf{w}^{T}\Phi - y)^T(\mathbf{w}^{T}\Phi - y)-\frac{\alpha}{2}\mathbf{w}^T\mathbf{w}+const\\&amp;=&amp;-\frac{1}{2}(\beta\mathbf{w}^T\Phi^T\Phi\mathbf{w}+\alpha\mathbf{w}^T\mathbf{w})+(\beta\mathbf{y}^T\Phi)\mathbf{w}+const\\&amp;=&amp;-\frac{1}{2}\mathbf{w}^T(\beta\Phi^T\Phi+\alpha\mathbf{I})\mathbf{w}+(\beta\mathbf{y}^T\Phi)\mathbf{w}+const\end{eqnarray}}$$

constはパラメータ$w$と無関係な値になっています。

パラメータ$w$の事後分布が求まりました。ここで、尤度（関数）と事前分布の関係が共役な関係になるように事前分布を選ぶと事後分布が事前分布と同じ分布になるので，事後分布は多変量ガウス分布$N(\mathbf{w}|\mathbf{\mu},S)$になります。

&nbsp;

つまり$p(\mathbf{w}|X)=N(\mathbf{w}|\mathbf{\mu},S)$です。

$n$変数の多変量正規分布は${f(\vec{x}) = \frac{1}{\sqrt{(2\pi)^n |\sum|}}exp \left \{-\frac{1}{2}{}^t (\vec{x}-\vec{\mu}) {\sum}^{-1} (\vec{x}-\vec{\mu}) \right \} }$の形で表すことができるので次の式が導けます。

$${\begin{eqnarray}\ln p(\mathbf{w}|X)&amp;=&amp;-\frac{1}{2}(\mathbf{w}-\mathbf{\mu})^TS^{-1}(\mathbf{w}-\mathbf{\mu})+const\\&amp;=&amp;-\frac{1}{2}\mathbf{w}^T S^{-1}\mathbf{w}+\mathbf{\mu} S^{-1}\mathbf{w}+const\end{eqnarray}}$$

2つの$p(\mathbf{w}|X)$の式を比較してみます。

[st-mybox title="" fontawesome="" color="#757575" bordercolor="#ccc" bgcolor="#ffffff" borderwidth="2" borderradius="2" titleweight="bold" fontsize="" myclass="st-mybox-class" margin="25px 0 25px 0"]

$$\ln p(\mathbf{w}|X)=-\frac{1}{2}\mathbf{w}^T(\beta\Phi^T\Phi+\alpha\mathbf{I})\mathbf{w}+(\beta\mathbf{y}^T\Phi)\mathbf{w}+const$$

[/st-mybox]

[st-mybox title="" fontawesome="" color="#757575" bordercolor="#ccc" bgcolor="#ffffff" borderwidth="2" borderradius="2" titleweight="bold" fontsize="" myclass="st-mybox-class" margin="25px 0 25px 0"]

$$\ln p(\mathbf{w}|X)=-\frac{1}{2}\mathbf{w}^T S^{-1}\mathbf{w}+\mathbf{\mu} S^{-1}\mathbf{w}+const$$

[/st-mybox]

したがって次のことが成り立ちます。

$$S^{-1}=\beta\Phi^T\Phi+\alpha\mathbf{I}$$

$$\mathbf{\mu}S^{-1}=\beta\mathbf{y}^T\Phi$$

Sについて解くと

$$\mathbf{S}=(\beta\Phi^{T}\Phi+\alpha \mathbf{I})^{-1}$$

$\mu$について解くと

$${\begin{eqnarray} \mathbf{\mu}^T\mathbf{S}^{-1}&amp;=&amp;\beta\mathbf{y}^T\Phi\\\mathbf{\mu}^T&amp;=&amp;\beta\mathbf{y}^T\Phi S\\ \mathbf{\mu}^T&amp;=&amp;\beta\mathbf{y}^T\Phi (\beta\Phi^{T}\Phi+\alpha \mathbf{I})^{-1}\\ \mathbf{\mu}^T&amp;=&amp;\mathbf y^T\Phi(\Phi^T\Phi+\lambda \mathbf I)^{-1}\\ \end{eqnarray}}$$

ゆえに

$${\begin{eqnarray} \mathbf{\mathbf{\mu}} &amp;=&amp;(y^T\Phi(\Phi^T\Phi+\lambda \mathbf I)^{-1})^T\\ &amp;=&amp;((\Phi^{T}\Phi+\lambda \mathbf{I})^{-1})^T(\mathbf y^T\Phi)^T\\ &amp;=&amp;(\Phi^{T}\Phi+\lambda \mathbf{I})^{-1}\Phi^{T}\mathbf{y} \end{eqnarray} }$$

このとき<span style="font-size: 16px; white-space: nowrap;">$(\Phi^{T}\Phi+\lambda \mathbf{I})^{-1}$</span>は対称行列、$\lambda$は<span style="font-size: 16px; white-space: nowrap;">$\lambda=\frac{\alpha}{\beta}$</span>です。

まとめますと

[st-mybox title="" fontawesome="fa-check-circle" color="#1f3134" bordercolor="#426579" bgcolor="#badcad" borderwidth="2" borderradius="5" titleweight="bold" fontsize="" myclass="st-mybox-class" margin="25px 0 25px 0"]

事後分布が多変量ガウス分布$N(\mathbf{w}|\mathbf{\mu},S)$のとき，その$\mu$と$S$は，

$${\begin{eqnarray} \mathbf{S}&amp;=&amp;(\beta\Phi^{T}\Phi+\alpha \mathbf{I})^{-1}\\ \mathbf{\mu}&amp;=&amp;(\Phi^{T}\Phi+\lambda \mathbf{I})^{-1}\Phi^{T}\mathbf{y} \end{eqnarray} }$$

[/st-mybox]

&nbsp;

<h2>新規の入力$x^{\ast}$に対する予測確率分布$p(y^{\ast}|x^{\ast},X)$を求める</h2>
推定された事後分布から、新規の入力$x^{\ast}$に対する予測確率分布$p(y^{\ast}|x^{\ast},X)$を考えていきます。

$${\begin{eqnarray}p(y^{\ast}|x^{\ast},X)&amp;=&amp;\int p(y^{\ast}|x^{\ast},\mathbf{w})p(\mathbf{w}|X)d \mathbf{w}\\&amp;=&amp;\int N\left(y_n|f(x_n),\beta^{^-1}\right)N(\mathbf{w}|\mathbf{\mu},S)d \mathbf{w}\end{eqnarray} }$$

この予測分布の式は、ガウス分布同士の畳み込み積分になっています。ここで，ガウス分布同士の畳み込み積分を求める公式を使って計算していくと次の式が得られます。非常に難しい計算で膨大になるので省略して結果だけのせます。(ここはいつかLatexで書いて証明したい)

[st-mybox title="ガウス過程回帰の式" fontawesome="fa-check-circle" color="#1f3134" bordercolor="#426579" bgcolor="#badcad" borderwidth="2" borderradius="5" titleweight="bold" fontsize="" myclass="st-mybox-class" margin="25px 0 25px 0"]

$$p(y^{\ast}|\mathbf{x}^{\ast},X,Y)=\mathcal{N}(\mathbf{k}^T_{\ast}\mathbf{K}^{-1}\mathbf{Y},\mathbf{k}_{\ast,\ast}-\mathbf{k}^T_{\ast}\mathbf{K}^{-1}\mathbf{k}_{\ast})$$

式の左辺の$Y$は今まで省略していました。

$\mathbf{k}_{\ast}$は$X$と$\mathbf{x}^{\ast}$のカーネル、$\mathbf{K}$は$X$と$X$のカーネル、$\mathbf{K}_{\ast,\ast}$は$\mathbf{x}^{\ast}$と$\mathbf{x}^{\ast}$のカーネルです．

[/st-mybox]

<h2>終わりに</h2>
長い記事になりましたが最終的にガウス過程回帰の式を導出することができました。

実装やガウスの性質については別記事に書きたいと思います。

ここまで読んでくださってありがとうございました。

見にくいところや間違っているところの編集リクエストもお待ちしています。

&nbsp;
