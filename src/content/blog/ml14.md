---
title: "ステップ関数とシグモイド関数のきほんのきほん"
description: ""
pubDate: "Jul 08 2023"
pubDatetime: 2023-09-20T15:33:05.569Z
summary: A simple blog post with a single-column layout and an optional cover banner.
date: 2024-02-12
postLayout: simple
---

<span style="font-size: 16px;">
本記事では活性化関数の、<span class="hutoaka"><span class="st-mycolor" style="font-size: 18px; color: #000000; font-family: arial, helvetica, sans-serif;"><span class="ymarker">ステップ関数とシグモイド関数</span></span></span>を紹介したいと思います。</span>

ニューラルネットワークやディープラーニングを理解しようと思ったら、活性化関数の理解は必須になります。

<span style="font-size: 16px;">活性化関数にはパーセプトロンの知識があると容易に理解できます。パーセプトロンについては以下の記事を参照してください。</span>

&nbsp;

[st-card myclass="" id=787 label="関連記事" pc_height="" name="" bgcolor="" color="" fontawesome="" readmore="on"]

&nbsp;

<h2><span style="font-size: 24px;">活性化関数とは</span></h2>
<span style="font-size: 16px;">活性化関数とは、</span><strong><span style="font-size: 20px;"><span class="ymarker">入力の信号を出力信号に変換する関数</span></span></strong>のことです。

<span style="font-size: 16.5px;">入力(信号)の総和を、どのように活性化(発火とも言います)させるかを決定させます。</span>

&nbsp;

<span style="font-size: 16.5px;">例えば、下の図のように 3 つのノードからの入力があるとしまし。
一番上の ❶ はバイアスと言われるものです。バイアスをコントロールすることで、出力（発火）のしやすさをコントロールします。</span>

<span style="font-size: 16.5px;">このときの入力の式を書くと</span>

\[
y = \begin{cases}
1 &amp; h(X) \ge 0 \ \text{のとき} \\
0 &amp; h(X) &lt; 0 \ \text{のとき}
\end{cases}
\]

$$h(X) = X_1W_1+X_2W_2+b$$

<span style="font-size: 16.5px;">になります。この$h(X)$を活性化関数といいます。この場合の活性化関数は、入力の総和が 0 より大きいかどうかで 1 を出力(発火)します。</span>

![blog placeholder](/src/assets/post/ml14-1.jpg)

&nbsp;

<span style="font-size: 16.5px;">この活性化関数にはステップ関数とシグモイド関数というのがあります。それらの特徴を見ていきましょう。</span>

<h2><span style="font-size: 24px;">ステップ関数</span></h2>
<span style="font-size: 16.5px;">ステップ関数は階段関数とも呼ばれており、先ほどの例の活性化関数がステップ関数になります。式で表すと、</span>

\[
y = \begin{cases}
1 &amp; h(X) \ge 0 \ \text{のとき} \\
0 &amp; h(X) &lt; 0 \ \text{のとき}
\end{cases}
\]

<span style="font-size: 16.5px;">です。
</span>

<span style="font-size: 16.5px;"><span style="font-size: 20px;"><strong><span class="ymarker">h(X)が 0 を超えるかどうかで 1 を出力します。0 を超えない場合は 0 を出力します。</span></strong></span></span>

<span style="font-size: 16.5px;">python コードで実装して見ていきましょう。</span>

<strong>関数定義</strong>

<pre><code class="python"><span style="font-size: 18px;">import numpy as np
import matplotlib.pylab as plt 
def step_function(A): 
   return np.array(A &gt; 0 , dtype=np.int)</span></code></pre>

<span style="font-size: 16.5px;">まず、ステップ関数を定義します。これは、A の値が 0 より大きいなら 1 を返し、それ以外は 0 を返すというものです。</span>

<strong>データの用意</strong>

<pre><span style="font-size: 18px;"><code class="python">w = np.array([[2.1, 0.2, -1.2],[0.2, 0.3, 0.9]])
b = np.array([1, 0.1, 0.3])
x = np.array([1.1, 0.6])</code></span></pre>

<span style="font-size: 16.5px;">重みパラメータとバイアスパラメータ、入力信号の値を用意しました。</span>

<span style="font-size: 16.5px;">これを、$h(X) = X_1W_1+X_2W_2+b$に代入して計算して、ステップ関数に入力します。</span>

<pre><code class="python"><span style="font-size: 18px;">A = np.dot(x,w)+b    <span style="font-size: 12px;">#出力結果:[ 3.43  0.5  -0.48]</span></span>
<span style="font-size: 18px;">y = step_function(A)
print(y)   </span>                     <span style="font-size: 12px;"> #出力結果:[1 1 0]</span></code> <span style="font-size: 16.5px;"> しっかりと0より大きい場合は1を出力して、小さい場合は0を出力できていますね。</span></pre>
<pre><span style="font-size: 16.5px;">ステップ関数は、グラフで表すと下図のようになります。

</span></pre>
<pre><span style="font-size: 16.5px;"> 0を境にして値が変わってます。</span></pre>
<pre><span style="font-size: 16.5px;">このように、階段的に変化するから<span style="font-size: 20px;"><strong>階段関数</strong></span>とも言われています。</span></pre>

![blog placeholder](/src/assets/post/ml14-2.jpg)

<h2><span style="font-size: 24px;">シグモイド関数</span></h2>
シグモイド関数は、以下の式で表されます。

$$y = \frac{1}{1 + e^{-x}}$$

これだけです。

実際に実装していきましょう。

ステップ関数で行ったことを省くため、データの用意などのプログラムを全て入れます。

```py
import numpy as np
import matplotlib.pylab as plt
#関数定義
def sigmoid(A):
return 1 / (1 + np.exp(-x))
#データの用意
w = np.array([[2.1, 0.2, -1.2],[0.2, 0.3, 0.9]])
b = np.array([1, 0.1, 0.3])
x = np.array([1.1, 0.6])
#計算式に代入して、シグモイド関数に入力する
A = np.dot(x,w)+b
y = sigmoid(A)
print(y)
----------------------------
[0.75026011 0.64565631]
```

ステップ関数と違って、実数の値を出力しているのがわかりますね。
一般に、シグモイド関数は下図で表されます。ステップ関数と違い滑らかな曲線を描くのが特徴です。

![blog placeholder](/src/assets/post/ml14-3.jpg)

[st-midasibox title="メモ" fontawesome="fa-file-text-o faa-float animated" bordercolor="#81d742" color="" bgcolor="#FAFAFA" borderwidth="" borderradius="5" titleweight="bold"]

ステップ関数は階段的な出力に対し、シグモイド関数は滑らかな出力になる。

[/st-midasibox]

&nbsp;
