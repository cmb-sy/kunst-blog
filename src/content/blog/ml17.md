---
title: "ロジスティック写像の挙動を確認してみる"
description: ""
pubDate: "Jul 08 2023"
pubDatetime: 2023-09-20T15:33:05.569Z
summary: A simple blog post with a single-column layout and an optional cover banner.
date: 2024-02-12
postLayout: simple
---

&nbsp;

最近、ロジスティック写像を使う機会がありました。

ロジスティック写像のことを調べていると、思っていた以上に難しいので自分なりに理解しようと記事にしてみました。

本記事では、そのロジスティック写像についての記事になります。

<h2>概要</h2>
ロジスティック写像は1次元の離散時系列であり、 時系列解析の研究のベンチマークデータとして用いられています。なぜなら、ロジスティック写像はカオスを生み出す非線形関数であり、その非線形関数の中では単純なものであり扱いやすいからです。この単純さと、他のカオスとも共通する現象がいくつも現れることからカオス理論の入り口としてもよく扱われます。

ロジスティック写像は下記の<span class="st-mymarker-s">差分方程式</span>で表され、図のように山形の曲線を描きます。また、$a$の値によって山の大きさが変わります。

$x_{t+1}=a x_{t}(1-x_{t})$

<a href="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-06-22-8.24.26-scaled.jpg"><img class="aligncenter wp-image-1745" src="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-06-22-8.24.26-scaled.jpg" alt="" width="652" height="403" /></a>

<h2>蜘蛛の巣図法</h2>
ロジスティック写像がどういった振る舞いをするのかを表現するためには、蜘蛛の巣図法を用いる必要があります。

蜘蛛の巣図法とは、<span class="st-mymarker-s">一次元離散力学系の振る舞いを図式的に表す手法</span>のことを言います。

蜘蛛の巣図法では、下記の図のように補助線と言われる$y=x$の関数を使います。

<a href="https://cmbnur.com/wp-content/uploads/I-am-Human-5.png"><img class="aligncenter size-full wp-image-1871" src="https://cmbnur.com/wp-content/uploads/I-am-Human-5.png" alt="" width="960" height="540" /></a>

&nbsp;

<div class="st-editor-margin" style="margin-bottom: -5px;">[st-minihukidashi fontawesome="" fontsize="80" fontweight="" bgcolor="#66BB6A" color="#fff" margin="0 0 0 -8px"]<span style="color: #000000;">離散力学系って？</span>[/st-minihukidashi]</div>
[st-cmemo fontawesome="fa-search" iconcolor="#66BB6A" bgcolor="#E8F5E9" color="#000000" iconsize="200"]

<span style="color: #000000;">力学系とは状態の変化の法則を記述した数学モデルのことで、離散力学は常差分方程式系 (漸化式)として表されます。力学系は下式(1 次元離散力学系の式)のように出力が次の入力となります。</span>

<span style="color: #000000;">$$ x\_{t+1}=f(x_t)$$</span>

[/st-cmemo]

&nbsp;

では蜘蛛の巣図法を詳しく見ていきます。

蜘蛛の巣図法では$y=x$の補助線を引きます。この補助線のおかげで、<span style="color: #000000;">力学系の出力が次の入力になることを表すことができます。</span>

下図で見てみます。

<a href="https://cmbnur.com/wp-content/uploads/I-am-Human.png"><img class="aligncenter size-full wp-image-1863" src="https://cmbnur.com/wp-content/uploads/I-am-Human.png" alt="" width="960" height="540" /></a>

<a href="https://cmbnur.com/wp-content/uploads/I-am-Human-1.png"><img class="aligncenter size-full wp-image-1864" src="https://cmbnur.com/wp-content/uploads/I-am-Human-1.png" alt="" width="960" height="540" /></a>

<a href="https://cmbnur.com/wp-content/uploads/I-am-Human-2.png"><img class="aligncenter size-full wp-image-1865" src="https://cmbnur.com/wp-content/uploads/I-am-Human-2.png" alt="" width="960" height="540" /></a><a href="https://cmbnur.com/wp-content/uploads/I-am-Human-3.png"><img class="aligncenter size-full wp-image-1866" src="https://cmbnur.com/wp-content/uploads/I-am-Human-3.png" alt="" width="960" height="540" /></a>

&nbsp;

<a href="https://cmbnur.com/wp-content/uploads/I-am-Human-4.png"><img class="aligncenter size-full wp-image-1867" src="https://cmbnur.com/wp-content/uploads/I-am-Human-4.png" alt="" width="960" height="540" /></a>

&nbsp;

$y=x$のおかげで、<span style="color: #000000;">力学系の出力が次の入力になることを表すことができています。</span>

では、この蜘蛛の巣図法について 100 エポックほどの挙動を見てみましょう。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-11.mp4"][/video]

&nbsp;

まるで、蜘蛛の巣のような図になっていきます。

この蜘蛛の巣図法によって、差分方程式の解の挙動が一目でわかる全体像がわかるのです。

&nbsp;

<h2>パラメータ$a$の違いによる振る舞い</h2>
概要のところでロジスティック写像は$a$が異なることで山の大きさが変わると言いました。

$$x_{t+1}=ax_t(1-x_t)$$

この山の大きさによってロジスティック写像の振る舞いがどのように変わるのかを見ていきたいと思います。

<h3>$0\leqq a \leqq 1$のとき</h3>
$a=0.5$、初期値が$x_0=0.5$のときロジスティック写像は$y=x$との交点(不動点)である$0$へ収束します。

初期値が$0$から$1$の範囲でどんな値をとっても同じ現象になります。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-12.mp4"][/video]

最終的に収束していく点を<strong>固定点</strong>、<strong>不動点</strong><sup id="cite_ref-FOOTNOTE小室2005112_35-0" class="reference"></sup>あるいは<strong>吸引的不動点</strong>、<strong>沈点</strong>などと呼びます。

また、十分な時間経過後にその力学系が漸近する集合は<span class="st-mymarker-s">アトラクタ</span>と言われます。

この場合、$<i>x</i> = 0$がアトラクタと言われます。

<div class="st-editor-margin" style="margin-bottom: -5px;">[st-minihukidashi fontawesome="" fontsize="80" fontweight="" bgcolor="#66BB6A" color="#fff" margin="0 0 0 -8px"]<span style="color: #000000;">アトラクタ</span>[/st-minihukidashi]</div>
[st-cmemo fontawesome="fa-search" iconcolor="#66BB6A" bgcolor="#E8F5E9" color="#000000" iconsize="200"]

<span style="color: #000000;">アトラクタとは英語の引きつける意味の attract から生まれた名詞です。
</span><span style="color: #000000;">ある力学系がそこに向かって時間発展をする集合のことであり、その力学系においてアトラクタに十分近い点から運動するとき、そのアトラクタに十分近いままであり続けます。
</span>

<span style="color: #000000;">余談ですが、一般的に、力学系は分析対象となる系の構造が明らかでない場合や、すべての状態変数を観測することが困難な場合が多いです。
</span><span style="color: #000000;">そのため、１個の状態変数からｄ個の状態変数を復元するターケンスの埋め込み定理というのを用いることで、アトラクタを再構成することができます。</span>

[/st-cmemo]

<h3>$1 &lt; a \leqq 2$のとき</h3>
$a$が$1 &lt; a &lt; \leqq2$のとき、ロジスティック写像は不動点である$1-\frac{1}{a}$へ収束します。

ここでの初期値は$x_0=0.1$です。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-13.mp4"][/video]

&nbsp;

<h3>$2 &lt; a \leqq 3$のとき</h3>
初期値0、1を除いてロジスティック写像は不動点である$1-\frac{1}{a}$へ収束します。

このとき、単調増加または単調減少ではなく、不動点の周囲をグルグル周りながら収束していきます。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-14.mp4"][/video]

&nbsp;

<h3>$3 &lt; a \leqq 3.449....$のとき</h3>
ロジスティック写像は不動点に収束するのではなく、不動点の周りをグルグル周って2つの値を交互に取る動きをします。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-15.mp4"][/video]

&nbsp;

図のように交互に 2 つの点を取ることを、<strong>周期点</strong><sup id="cite_ref-FOOTNOTEアリグッド・サウアー・ヨーク201214_48-0" class="reference"></sup>や<strong>平衡点</strong><sup id="cite_ref-FOOTNOTE下條199244_33-2" class="reference"></sup>と呼びます。このとき、周期点を 2 周期点といい<sup id="cite_ref-FOOTNOTE船越200829_49-0" class="reference"></sup>、そしてその振る舞いを 2 周期軌道<sup id="cite_ref-FOOTNOTE小室2005112_35-1" class="reference"></sup>などと呼びます。

不動点と同様に、周期点にも安定なものと不安定なものが存在します。$3 &lt; a \leqq 3.449....$の範囲における 2 周期点は安定周期点です。

下図は、$x_t$と$t$の関係性を表した図です。値がずっと 2 つの値を取り続けていくのがわかります。

<a href="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-09-12-8.31.56.png"><img class="aligncenter wp-image-1816" src="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-09-12-8.31.56.png" alt="" width="469" height="365" /></a>

&nbsp;

<h3>$3.449... &lt; a \leqq 3.569....$のとき</h3>
$a$が$3.449... &lt; a \leqq 3.569....$のとき、ロジスティック写像は安定な<span class="st-mymarker-s">4周期軌道の状態</span>になります。

つまり、グルグルと回りながら 4 つの値を取り続けます。

このパタメータ$a$の値を大きくしていくと、ロジスティック写像では 4 周期から 8 周期、8 周期から 16 周期、16 周期から 32 周期軌道の状態へと動きが変わっていきます。例えば、$a=3.56$ならば 8 周期です。<sup id="cite_ref-FOOTNOTE下條199245_60-0" class="reference"></sup>

この軌道の状態が$a$の値によって変わることを<span class="st-mymarker-s">周期倍分岐</span>と言います。

※実行速度、エポック数は今までと異なる設定になっております。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-21.mp4"][/video]

&nbsp;

$x_t$と$t$の関係性を表した図を見ると、値がずっと 4 つの値を取り続けていることが確認できます。

<a href="https://cmbnur.com/wp-content/uploads/tmp.png"><img class="aligncenter size-full wp-image-1828" src="https://cmbnur.com/wp-content/uploads/tmp.png" alt="" width="640" height="480" /></a>

<h3>$3.569... &lt; a \leqq 4....$のとき</h3>
$a$が3.449を超えると、ロジスティック写像では<span class="st-mymarker-s">カオス</span>が発生します。
<div class="st-editor-margin" style="margin-bottom: -5px;">[st-minihukidashi fontawesome="" fontsize="80" fontweight="" bgcolor="#66BB6A" color="#fff" margin="0 0 0 -8px"]カオス[/st-minihukidashi]</div>
[st-cmemo fontawesome="fa-search" iconcolor="#66BB6A" bgcolor="#E8F5E9" color="#000000" iconsize="200"]

カオスとは、収束も周期性も無く不規則で複雑な挙動のことです。

厳密に何を持ってカオスを定義するかを話すのは難しいです。ここでは、まったく予測が困難なデタラメな動きのことをカオスだと思って下さい。

[/st-cmemo]

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-22.mp4"][/video]

&nbsp;

$x_t$と$t$の関係性を表した図を見てみます。

<a href="https://cmbnur.com/wp-content/uploads/tmp-1.png"><img class="aligncenter size-full wp-image-1830" src="https://cmbnur.com/wp-content/uploads/tmp-1.png" alt="" width="640" height="480" /></a>

値がデタラメ取り続けられていることがわかります。

しかし、$3.569... < a \leq 4....$では、常にカオス軌道を示す訳ではありません。$a$の値の領域によってはカオス軌道になったり周期軌道になったりする場合もあります。

例えば、$a=3.828327$のときだと下のようにカオス軌道になったり周期軌道になったりしています。

<a href="https://cmbnur.com/wp-content/uploads/tmp-2.png"><img class="aligncenter size-full wp-image-1831" src="https://cmbnur.com/wp-content/uploads/tmp-2.png" alt="" width="640" height="480" /></a>

<h3>$ 4 \leq a $のとき</h3>
<i>a</i> が 4 を超えるとほとんどの初期値$x_0$から始まる挙動はマイナス無限大へ発散してしまいます。

そのため、描画はできませんが描画してみます。

[video width="700" height="700" mp4="https://cmbnur.com/wp-content/uploads/animation-23.mp4"][/video]

軸の値を見るとわかりますが、マイナス無限大方向へ発散してしまっています。

$x_t$と$t$の関係性を表した図を見てみます。

<a href="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-10-04-8.15.11.png"><img class="aligncenter wp-image-1838" src="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-10-04-8.15.11.png" alt="" width="511" height="303" /></a>

軸の値を見るとわかりますが、マイナス無限大方向へ発散してしまっています。

&nbsp;

<h3>まとめ</h3>
ここまでロジスティック写像のパラメータ$a$の値による振る舞いを見てきました。

最後に横軸を$a$、縦軸を$x_t$として図にプロットしてみます。

<a href="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-10-13-6.41.13.png"><img class="aligncenter wp-image-1852" src="https://cmbnur.com/wp-content/uploads/スクリーンショット-2021-10-13-6.41.13.png" alt="" width="702" height="415" /></a>

最初 1 つの値に収束し、それが 2 つの値に収束する 2 周期軌道へなり、2 周期から 4 周期、4 周期から 8 周期、8 周期から 16 周期、16 周期から 32 周期... と周期倍分岐が発生しています。そしてカオスが発生して発散に至るのです。また、$a$が負の範囲のときの写像の分岐は、正の場合と似たような分岐になっていることがわかります。

&nbsp;

<h2>おまけ</h2>
ここからは余談になります。

個人的に気になったことを挙げていきます。

<h3>非線形関数の証明</h3>
ロジスティック写像は非線形性関数です。この証明をしていきます。

線形写像の定義は次のようになります。

[st-mybox title="線形写像の定義" fontawesome="fa-check-circle" color="#757575" bordercolor="#BDBDBD" bgcolor="#ffffff" borderwidth="2" borderradius="5" titleweight="bold" fontsize="" myclass="st-mybox-class" margin="25px 0 25px 0"]

<span class="katex-eq katex-rendered" data-katex-display="false"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="mord mathnormal">$V$,$W$</span></span></span></span></span>を$\mathbb{F}$上のベクトル空間とするとき、$f: V \rightarrow W$が<span class="marker-under"><strong>線形写像</strong></span>であるには

$$f(\boldsymbol{x}+\boldsymbol{y}) = f(\boldsymbol{x}) + f(\boldsymbol{y}), \quad \boldsymbol{x}, \boldsymbol{y} \in V$$

$$f(\boldsymbol{x}) = kf(\boldsymbol{x}), \quad k \in \mathbb{F}$$

の両方が成立する必要がある。

[/st-mybox]

この条件を満たすには以下の式が成り立たなくてはいけません。

$$f(x + y) -f(x) - f(y) = 0$$

ロジスティック写像は$f(x)=ax(1-x)$なので

$$a(x+y)(1-x-y) - ax(1-x) - ay(1-y) = 0$$

変形して計算していくと

$$x+y-x^2-xy-xy-y^2-x+x^2-y+y^2=0$$

$$-2xy = 0$$

従って、ロジスティック写像は線形写像の条件を満たさないので非線形関数である。

<div class="st-editor-margin" style="margin-bottom: -5px;">[st-minihukidashi fontawesome="" fontsize="80" fontweight="" bgcolor="#66BB6A" color="#fff" margin="0 0 0 -8px"]線形写像[/st-minihukidashi]</div>
[st-cmemo fontawesome="fa-search" iconcolor="#66BB6A" bgcolor="#E8F5E9" color="#000000" iconsize="200"]

<span style="color: #000000;">線形写像の条件を満たすもには基本的に 1 次関数です。そのため、2 次関数であるロジスティック写像は満たさないです。</span>

[/st-cmemo]

&nbsp;

<h2>終わりに</h2>
ロジスティック写像の実装ですが、思った以上に組むことが難しかったです。$a$の値をコンマ単位で変えるだけで挙動が大きく変わるため非常に繊細なものだと思いました。

ここまで読んでくださりありがとうございます。

修正リクエストをお待ちしてます。

&nbsp;
