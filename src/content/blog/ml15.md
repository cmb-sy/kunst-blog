---
title: "画像データの2値化"
description: ""
pubDate: "Jul 08 2023"
pubDatetime: 2023-09-20T15:33:05.569Z
---

本記事では二値画像の表現方法を紹介します。

さっそく見ていきましょう。

&nbsp;

今回使用する2値画像は下の図です。画素の総数が8×8の64画素になります。

固定閾値法で2値化します。閾値を4として、4より大きい値を1、それ以外を0とします。

このときの出力される2値画像は、背景(0)が黒く、オブジェクト(1)は白くなる画像です。

本記事では、その2値化画像を<span style="color: #0000ff;">画像A</span>と呼ぶことにします。

&nbsp;

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-7.png"><img class="aligncenter wp-image-1077" src="https://cmbnur.com/wp-content/uploads/キャプチャ-7.png" alt="" width="593" height="202" /></a>

<h2>ラベリング</h2>
<span style="font-weight: 400;">ラベリングとは、画像の中にある塊りごとにラベルを付けることをいいます。</span>

<span style="font-weight: 400;">ここでは、ピクセル値に1があるとラベルAを与えるとします。</span>

すると、<span style="color: #0000ff;">画像A</span>にラベリングすると下のようになります。

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-10.png"><img class="aligncenter wp-image-1080" src="https://cmbnur.com/wp-content/uploads/キャプチャ-10.png" alt="" width="289" height="374" /></a>

&nbsp;

<span style="font-weight: 400;">今回の図では、1つのオブジェクトにラベルAを与えました。</span>

<span style="font-size: 18px;"><span style="font-weight: 400;"><span class="ymarker">複数のオブジェクトがある場合は、異なるラベルを与えます。こうすると、</span><span style="font-weight: 400;"><span class="ymarker">1つの画像に複数のオブジェクトがあることがわかります。</span></span></span></span>

<span style="font-weight: 400;">ラベルは、各画素値が格納されている配列やメモリとは別に用意された配列やメモリに格納されます。異なる領域に属する画素に異なるラベルを割り当てるのです。</span>

&nbsp;

<h2>ラングレス符号化</h2>
ラングレス符号化は、連長圧縮とも言われ、<span style="color: #ff0000;">連続する同一の値を，その連なり（run）の長さ（length）を示す数字に置き換える</span>ことを言います。

<span style="color: #0000ff;">画像A<span style="color: #000000;">の行に着目して、順番に左から順に<span style="font-weight: 400;">画素を確認していきます。下の図のように、それぞれの行の連続した数値(run)の長さ(length)で表していきます。</span></span></span>

こうすることで、<span style="font-size: 18px;"><span class="ymarker">少ないビット数で表現できるようになります。</span></span>

&nbsp;

<span style="font-weight: 400;">背景画素値が0、オブジェクト画素値が1、背景画素がオブジェクトの周囲に常に存在するという3つの前提がわかっているならラングレスの長さだけで表せます。</span>

また、その前提条件なしの場合では、データ中のオブジェクトを連続する値で符号化していきます。

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-9.png"><img class="wp-image-1079 aligncenter" src="https://cmbnur.com/wp-content/uploads/キャプチャ-9.png" alt="" width="508" height="247" /></a>

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-11.png"><img class="wp-image-1081 aligncenter" src="https://cmbnur.com/wp-content/uploads/キャプチャ-11.png" alt="" width="498" height="263" /></a><a href="https://cmbnur.com/wp-content/uploads/2020/05/キャプチャ-11.png"><img class="aligncenter wp-image-970" src="https://cmbnur.com/wp-content/uploads/2020/05/キャプチャ-11.png" alt="" width="510" height="168" /></a>

<h2><span style="font-weight: 400;">チェーンコード化</span></h2>
チェーンエンコードとは、2値画像データを符号化する手法の事を言います。また、オブジェクトと背景の<span style="font-weight: 400;">境界をトラッキングし、方向に応じてエンコードします。</span>

<span style="font-weight: 400;">背景とオブジェクトの等高線（境界線）を抽出する方法は下記のステップで行います。</span>

<h5>step1</h5>
ラングレス符号化のように左上から順にオブジェクト値1が出るまでスキャンしていきます。そして、画素値1が出たらスキャンを止めます<span style="font-weight: 400;">。この画素がオブジェクトの始点となります。</span>

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-12.png"><img class="aligncenter wp-image-1082" src="https://cmbnur.com/wp-content/uploads/キャプチャ-12.png" alt="" width="339" height="326" /></a>

<h5>step2</h5>
<span style="font-weight: 400;">この始点画素を輪郭の一部として記録する。</span>
<h5>step3</h5>
<span style="font-weight: 400;">１画素前にスキャンした画素に戻ります。（0の画素ではなく、1の画素）</span>

<span style="font-weight: 400;">1回目ならstep3はスキップします。</span>

<h5>step4</h5>
<span style="font-weight: 400;">時計回りに周りのある８個の隣接画素をチェックします。画素値1が見つかったら、ステップ2に戻ります。</span>

このstepの繰り返しにとって、画素値が1の等高線（境界線）を抽出することができます。

&nbsp;

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-13.png"><img class="aligncenter wp-image-1083" src="https://cmbnur.com/wp-content/uploads/キャプチャ-13.png" alt="" width="633" height="291" /></a>

<span style="font-weight: 400;">等高線をエンコードしていきましょう。</span>

<span style="font-weight: 400;">下図のChain Encoding Coding表で、等高線を符号化していきます。</span>

始点となる画素（座標は（3,2））から<span style="font-weight: 400;">Chain Encoding Coding表に従って符号化します。</span>

すると、<strong>(3,2) 0, 0, 1, 2, 3, 4, 3, 5, 6, 6, 7</strong>という結果になりますね。

&nbsp;

<img class="wp-image-1084 aligncenter" src="https://cmbnur.com/wp-content/uploads/キャプチャ-14.png" alt="" width="240" height="205" />

&nbsp;

<h2>特徴抽出</h2>
<span style="font-weight: 400;">画像処理では、特徴抽出により次元削減をします。</span>

<span style="font-weight: 400;">面積、境界長、円形度、重心の特徴を計算していきます。例は先ほどと同じ二値画像です。</span>

&nbsp;

<h5>面積</h5>
<span style="font-weight: 400;">面積とは、オブジェクトの面積の中の画素数のことです。つまり、画素値が1の画素の数の個数です。この場合は、<strong>18</strong>になります。</span>
<h5>境界の長さ</h5>
<span style="font-weight: 400;">境界線の長さは、境界線上のピクセル数になりますが、矢印の個数を数えたほうがわかりやすいです。</span>

<span style="font-weight: 400;">境界線が対角線のときは、長さは2の平方根を掛けたものになります。</span>

<span style="font-weight: 400;">したがって、対角線の矢印は6個で、対角線を除いた矢印は3個なので、<strong>境界線の長さは√2×6+3で11.5になります。</strong></span>

<a href="https://cmbnur.com/wp-content/uploads/キャプチャ-17.png"><img class="aligncenter wp-image-1087" src="https://cmbnur.com/wp-content/uploads/キャプチャ-17.png" alt="" width="320" height="356" /></a>

<h5></h5>
<h5>円度</h5>
円度＝(境界線の長さ / 面積)の２乗

したがって、<strong>11.5の２乗/18で7.35になります。</strong>

<h5>重心</h5>
<span style="font-weight: 400;">重心は、座標値の和を面積で割ったものです。</span>

オブジェクトの座標の和を計算します。すると、<strong>(69,67)になるので面積18で割ると</strong>

<strong>（3.8,3.7）になります</strong>。
